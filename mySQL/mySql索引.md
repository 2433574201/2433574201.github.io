索引分**单列索引**和**组合索引**。单列索引，即一个索引只包含单个列，一个表可以有多个单列索引，但这不是组合索引。组合索引，即一个索包含多个列。

过多的使用索引将会造成滥用。因此索引也会有它的缺点：虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件。

建立索引会占用磁盘空间的索引文件。

``` sql
ALTER my_table ADD [UNIQUE] INDEX my_index(my_text);
```

# 索引的分类

**常见的索引类型有：主键索引、唯一索引、普通索引、全文索引、组合索引**

1、主键索引：即主索引，根据主键pk_clolum（length）建立索引，不允许重复，不允许空值；

``` sql
ALTER TABLE 'table_name' ADD PRIMARY KEY('col')；
```
2、唯一索引：用来建立索引的列的值必须是唯一的，允许空值

``` sql
ALTER TABLE 'table_name' ADD UNIQUE('col')；
```
3、普通索引：用表中的普通列构建的索引，没有任何限制

``` sql
ALTER TABLE 'table_name' ADD INDEX index_name('col')；
```
4、组合索引：用多个列组合构建的索引，这多个列中的值不允许有空值

``` sql
ALTER TABLE 'table_name' ADD INDEX index_name('col1','col2','col3')；
```
**遵循“最左前缀”原则，把最常用作为检索或排序的列放在最左，依次递减，组合索引相当于建立了col1,col1col2,col1col2col3三个索引，而col2或者col3是不能使用索引的。**

*在使用组合索引的时候可能因为列名长度过长而导致索引的key太大，导致效率降低，在允许的情况下，可以只取col1和col2的前几个字符作为索引*

``` sql
ALTER TABLE 'table_name' ADD INDEX index_name(col1(4),col2（3))；
```

# 索引的实现原理（暂时不做深入了解）

mySQL支持诸多存储引擎，每个存储引擎对索引的支持也不尽相同，因此mySQL数据库支持多种索引类型，如BTree索引、B+Tree索引、哈希索引、全文索引等等。

**1.哈希索引：**

只有memory（内存）存储引擎支持哈希索引，哈希索引用索引列的值计算该值的hashCode，然后在hashCode相应的位置存执该值所在行数据的物理位置，因为使用散列算法，因此访问速度非常快，但是一个值只能对应一个hashCode，而且是散列的分布方式，因此哈希索引不支持范围查找和排序的功能。

**2.全文索引：**

**3.BTree索引和B+Tree索引：**



# 索引的使用策略

**什么时候要使用索引？**

 - 主键自动建立唯一索引；
 - 作为排序的列要建立索引；
 - 查询中与其他表关联的字段，外键关系建立索引
 - 高并发条件下倾向组合索引；

**什么时候不要使用索引？**

 - 经常增删改的列不要建立索引；
 - 有大量重复的列不建立索引；
 - 表记录太少不要建立索引；

*在组合索引中不能有列的值为NULL，如果有，那么这一列对组合索引就是无效的；

*在一个SELECT语句中，索引只能使用一次，如果在WHERE中使用了，那么在ORDER BY中就不要用了；

*LIKE操作中，'%aaa%'不会使用索引，也就是索引会失效，但是‘aaa%’可以使用索引；

*在索引的列上使用表达式或者函数会使索引失效，例如：select * from users where YEAR(adddate)<2007，将在每个行上进行运算，这将导致索引失效而进行全表扫描，因此我们可以改成：select * from users where adddate<’2007-01-01′。

*在查询条件中使用正则表达式时，只有在搜索模板的第一个字符不是通配符的情况下才能使用索引。


*在查询条件中使用<>会导致索引失效。

*在查询条件中使用IS NULL会导致索引失效。

*在查询条件中使用OR连接多个条件会导致索引失效，这时应该改为两次查询，然后用UNION ALL连接起来。

*尽量不要包括多列排序，如果一定要，最好为这队列构建组合索引；

*只有当数据库里已经有了足够多的测试数据时，它的性能测试结果才有实际参考价值。如果在测试数据库里只有几百条数据记录，它们往往在执行完第一条查询命令之后就被全部加载到内存里，这将使后续的查询命令都执行得非常快--不管有没有使用索引。只有当数据库里的记录超过了1000条、数据总量也超过了MySQL服务器上的内存总量时，数据库的性能测试结果才有意义。

# 索引的优化

1、最左前缀
索引的最左前缀和和B+Tree中的“最左前缀原理”有关，举例来说就是如果设置了组合索引<col1,col2,col3>那么以下3中情况可以使用索引：col1，<col1,col2>，<col1,col2,col3>，其它的列，比如<col2,col3>，<col1,col3>，col2，col3等等都是不能使用索引的。

根据最左前缀原则，我们一般把排序分组频率最高的列放在最左边，以此类推。


参考博客：[https://blog.csdn.net/tongdanping/article/details/79878302](https://blog.csdn.net/tongdanping/article/details/79878302)